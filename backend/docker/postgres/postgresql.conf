# PostgreSQL Configuration File
# Optimized for 15GB RAM system

# Memory Settings
shared_buffers = 4GB                    # 25% of RAM (15GB * 0.25)
effective_cache_size = 11GB             # 75% of RAM (15GB * 0.75)
work_mem = 64MB                         # Per sort/join operation
maintenance_work_mem = 1GB              # For maintenance operations

# Connection Settings  
max_connections = 200                   # Adjust based on your needs

# WAL Settings
wal_buffers = 64MB                      # WAL buffer size
checkpoint_completion_target = 0.8      # Spread checkpoints over time
max_wal_size = 4GB                      # Maximum WAL size
min_wal_size = 1GB                      # Minimum WAL size

# Query Planner Settings
default_statistics_target = 100         # Statistics sampling
random_page_cost = 1.1                  # SSD optimized (lower than HDD default of 4.0)
effective_io_concurrency = 200          # SSD can handle many concurrent I/O
seq_page_cost = 1.0                     # Sequential scan cost

# CPU and Parallelism
max_worker_processes = 8                # Match CPU cores
max_parallel_workers = 6                # Leave some cores for other processes
max_parallel_workers_per_gather = 4     # Parallel workers per query
max_parallel_maintenance_workers = 4    # Parallel maintenance workers

# Logging (optional but recommended)
log_min_duration_statement = 1000       # Log slow queries (1+ seconds)
log_checkpoints = on                    # Log checkpoint activity
log_lock_waits = on                     # Log lock waits

# Required settings for Docker PostgreSQL
listen_addresses = '*'                  # Allow connections from all IPs
port = 5432                            # Default PostgreSQL port

# Additional performance settings
checkpoint_timeout = 10min              # Checkpoint every 10 minutes
wal_level = replica                     # For replication support
archive_mode = off                      # Disable archiving in development